<!-- HTML header for doxygen 1.9.5-->
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
  <meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=11" />
  <meta name="generator" content="Doxygen 1.9.7" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>OpenPFC: an open source framework for high performance 3D phase field crystal simulations</title>
  <link href="tabs.css" rel="stylesheet" type="text/css" />
  <script type="text/javascript" src="jquery.js"></script>
  <script type="text/javascript" src="dynsections.js"></script>
  <script type="text/javascript" src="doxygen-awesome-darkmode-toggle.js"></script>
  <script type="text/javascript" src="doxygen-awesome-fragment-copy-button.js"></script>
  <script type="text/javascript" src="doxygen-awesome-paragraph-link.js"></script>
  <script type="text/javascript" src="doxygen-awesome-interactive-toc.js"></script>
  <script type="text/javascript">
    DoxygenAwesomeFragmentCopyButton.init()
    DoxygenAwesomeDarkModeToggle.init()
    DoxygenAwesomeParagraphLink.init()
    DoxygenAwesomeInteractiveToc.init()
  </script>
  <link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
  <link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
  <link href="doxygen.css" rel="stylesheet" type="text/css" />
  <link href="custom.css" rel="stylesheet" type="text/css"/>
<link href="doxygen-awesome.css" rel="stylesheet" type="text/css"/>
<link href="doxygen-awesome-sidebar-only.css" rel="stylesheet" type="text/css"/>
<link href="doxygen-awesome-sidebar-only-darkmode-toggle.css" rel="stylesheet" type="text/css"/>
  <style>
    .github-corner svg {
      fill: var(--primary-light-color);
      color: var(--page-background-color);
      width: 72px;
      height: 72px;
    }
    .github-corner:hover .octo-arm {
      animation: octocat-wave 560ms ease-in-out
    }
    @keyframes octocat-wave {
      0%,
      100% {
        transform: rotate(0)
      }
      20%,
      60% {
        transform: rotate(-25deg)
      }
      40%,
      80% {
        transform: rotate(10deg)
      }
    }
    @media (max-width:500px) {
      .github-corner:hover .octo-arm {
        animation: none
      }
      .github-corner .octo-arm {
        animation: octocat-wave 560ms ease-in-out
      }
    }
    @media screen and (max-width: 767px) {
      .github-corner svg {
        width: 50px;
        height: 50px;
      }
      #projectnumber {
        margin-right: 22px;
      }
    }
  </style>
</head>
<body>
  <!-- https://tholman.com/github-corners/ -->
  <a href="https://github.com/VTT-ProperTune/OpenPFC" class="github-corner" title="View source on GitHub"
    target="_blank">
    <svg viewBox="0 0 250 250" width="40" height="40"
      style="position: absolute; top: 0; border: 0; right: 0; z-index: 99;" aria-hidden="true">
      <path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path>
      <path
        d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2"
        fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path>
      <path
        d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z"
        fill="currentColor" class="octo-body"></path>
    </svg></a>
    <div id="top">
      <!-- do not remove this div, it is closed by doxygen! -->
      <div id="titlearea">
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr id="projectrow">
              <td id="projectlogo"><img alt="Logo" src="logo.png" /></td>
              <td id="projectalign">
                <div id="projectname">OpenPFC
                  <span id="projectnumber">&#160;0.1.0</span>
                </div>
                <div id="projectbrief">Phase Field Crystal simulation framework</div>
              </td>
            </tr>
          </tbody>
        </table>
      </div>
      <!-- end header part -->
<!-- Generated by Doxygen 1.9.7 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('05_simulator_8cpp-example.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="headertitle"><div class="title">05_simulator.cpp</div></div>
</div><!--header-->
<div class="contents">
<p>In the previous example, a simple diffusion model was implemented. The implementation was done at a rather low level for demonstration reasons and it had a few flaws. First, time stepping should be performed at a higher level. Hard-coding the initial condition inside the model also does not follow the good implementation practices of modular code. Later, we also want, for example, boundary conditions or to write the results of the simulation to the hard disk. These are all examples of things that basically should not be implemented in the model, because the model mainly includes physics. We want to use initial conditions and boundary conditions more widely in more different models.</p>
<p>This example introduces a few new classes: Time, Simulator, and FieldModifier. The responsibility of the Time object is to take care of the time step and to tell when the results of the calculation should be saved. The Simulator class combines model, time, initial conditions, and boundary conditions, being a higher-level abstraction of computation. The initial condition is implemented by inheriting the class FieldModifier. Initial conditions and boundary conditions can be implemented in the same class, therefore a slightly more generic name for the initial condition class.</p>
<div class="fragment"><div class="line"> </div>
<div class="line"><span class="preprocessor">#include &lt;array&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;iostream&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;limits&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;memory&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="decomposition_8hpp.html">openpfc/decomposition.hpp</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="fft_8hpp.html">openpfc/fft.hpp</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="field__modifier_8hpp.html">openpfc/field_modifier.hpp</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="model_8hpp.html">openpfc/model.hpp</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="simulator_8hpp.html">openpfc/simulator.hpp</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="world_8hpp.html">openpfc/world.hpp</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;vector&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="keyword">using namespace </span><a class="code hl_namespace" href="namespacepfc.html">pfc</a>;</div>
<div class="line"> </div>
<div class="line"><span class="keyword">const</span> <span class="keywordtype">double</span> <a id="a0" name="a0"></a><a class="code hl_variable" href="05__simulator_8cpp.html#a952eac791b596a61bba0a133a3bb439f">PI</a> = 3.141592653589793238463;</div>
<div class="line"> </div>
<div class="line"><span class="keyword">class </span><a id="_a1" name="_a1"></a><a class="code hl_class" href="classGaussianIC.html">GaussianIC</a> : <span class="keyword">public</span> <a id="_a2" name="_a2"></a><a class="code hl_class" href="classpfc_1_1FieldModifier.html">FieldModifier</a> {</div>
<div class="line"><span class="keyword">private</span>:</div>
<div class="line">  <span class="keywordtype">double</span> D = 1.0;</div>
<div class="line"> </div>
<div class="line"><span class="keyword">public</span>:</div>
<div class="line">  <span class="keywordtype">void</span> <a id="a3" name="a3"></a><a class="code hl_function" href="classGaussianIC.html#a2904703e53544be07ff7f2131ed82230">apply</a>(<a id="_a4" name="_a4"></a><a class="code hl_class" href="classpfc_1_1Model.html">Model</a> &amp;m, <span class="keywordtype">double</span> t)<span class="keyword"> override </span>{</div>
<div class="line">    (void)t; <span class="comment">// suppress compiler warning about unused parameter</span></div>
<div class="line">    <span class="keyword">const</span> <a id="_a5" name="_a5"></a><a class="code hl_class" href="classpfc_1_1World.html">World</a> &amp;w = m.<a id="a6" name="a6"></a><a class="code hl_function" href="classpfc_1_1Model.html#ac60d580e7e9ce3a268414f92131a95e1">get_world</a>();</div>
<div class="line">    <span class="keyword">const</span> <a id="_a7" name="_a7"></a><a class="code hl_class" href="classpfc_1_1Decomposition.html">Decomposition</a> &amp;decomp = m.<a id="a8" name="a8"></a><a class="code hl_function" href="classpfc_1_1Model.html#a114dbe9ce04ba6e719e232dea52d4313">get_decomposition</a>();</div>
<div class="line">    std::vector&lt;double&gt; &amp;field = m.<a id="a9" name="a9"></a><a class="code hl_function" href="classpfc_1_1Model.html#a3388b9c18e0dc205cc15f1392e5c8f4b">get_real_field</a>(<span class="stringliteral">&quot;psi&quot;</span>);</div>
<div class="line">    std::array&lt;int, 3&gt; low = decomp.<a id="a10" name="a10"></a><a class="code hl_variable" href="classpfc_1_1Decomposition.html#a78a2cd4304a8a69665c3b24503ff8c73">inbox</a>.low;</div>
<div class="line">    std::array&lt;int, 3&gt; high = decomp.<a class="code hl_variable" href="classpfc_1_1Decomposition.html#a78a2cd4304a8a69665c3b24503ff8c73">inbox</a>.high;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (m.<a id="a11" name="a11"></a><a class="code hl_function" href="classpfc_1_1Model.html#adcf94d7a4a1351b513bacd1860762f9c">is_rank0</a>()) std::cout &lt;&lt; <span class="stringliteral">&quot;Create initial condition&quot;</span> &lt;&lt; std::endl;</div>
<div class="line">    <span class="keywordtype">size_t</span> idx = 0;</div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = low[2]; k &lt;= high[2]; k++) {</div>
<div class="line">      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = low[1]; j &lt;= high[1]; j++) {</div>
<div class="line">        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = low[0]; i &lt;= high[0]; i++) {</div>
<div class="line">          <span class="keywordtype">double</span> x = w.<a id="a12" name="a12"></a><a class="code hl_variable" href="classpfc_1_1World.html#acc6ffdae16ec121877b6b52eb4d20b6e">x0</a> + i * w.<a id="a13" name="a13"></a><a class="code hl_variable" href="classpfc_1_1World.html#a78728443e7c39c89da0a919fcdb584df">dx</a>;</div>
<div class="line">          <span class="keywordtype">double</span> y = w.<a id="a14" name="a14"></a><a class="code hl_variable" href="classpfc_1_1World.html#af70d91e76a70f703b84394a8f58df90d">y0</a> + j * w.<a id="a15" name="a15"></a><a class="code hl_variable" href="classpfc_1_1World.html#a07404e069e3188e737c45964446dec49">dy</a>;</div>
<div class="line">          <span class="keywordtype">double</span> z = w.<a id="a16" name="a16"></a><a class="code hl_variable" href="classpfc_1_1World.html#a4a5f1f99377c9ad310c15bfeba8c7fee">z0</a> + k * w.<a id="a17" name="a17"></a><a class="code hl_variable" href="classpfc_1_1World.html#aefac04e64d4287f792ecb22e7f0f3c2f">dz</a>;</div>
<div class="line">          field[idx] = exp(-(x * x + y * y + z * z) / (4.0 * D));</div>
<div class="line">          idx += 1;</div>
<div class="line">        }</div>
<div class="line">      }</div>
<div class="line">    }</div>
<div class="line">  }</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"><span class="keyword">class </span><a id="_a18" name="_a18"></a><a class="code hl_class" href="classDiffusion.html">Diffusion</a> : <span class="keyword">public</span> <a class="code hl_class" href="classpfc_1_1Model.html">Model</a> {</div>
<div class="line">  <span class="keyword">using </span>Model::Model;</div>
<div class="line"> </div>
<div class="line"><span class="keyword">private</span>:</div>
<div class="line">  std::vector&lt;double&gt; opL, psi;</div>
<div class="line">  std::vector&lt;std::complex&lt;double&gt;&gt; psi_F;</div>
<div class="line">  <span class="keywordtype">double</span> <a id="a19" name="a19"></a><a class="code hl_variable" href="classDiffusion.html#a6ad3de2af17be6a8bd02984e44eeae52">psi_min</a> = 0.0, <a id="a20" name="a20"></a><a class="code hl_variable" href="classDiffusion.html#ac1d50c7d6399f40c5ded1f6cb18101c7">psi_max</a> = 1.0;</div>
<div class="line"> </div>
<div class="line"><span class="keyword">public</span>:</div>
<div class="line">  <span class="keywordtype">double</span> <a id="a21" name="a21"></a><a class="code hl_function" href="classDiffusion.html#aeb47728c34eb1ec81b4ab30e02ca156a">get_psi_min</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> <a class="code hl_variable" href="classDiffusion.html#a6ad3de2af17be6a8bd02984e44eeae52">psi_min</a>; }</div>
<div class="line">  <span class="keywordtype">double</span> <a id="a22" name="a22"></a><a class="code hl_function" href="classDiffusion.html#ad4262b0cb5f4db417674f9915c43ee48">get_psi_max</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> <a class="code hl_variable" href="classDiffusion.html#ac1d50c7d6399f40c5ded1f6cb18101c7">psi_max</a>; }</div>
<div class="line"> </div>
<div class="line">  <span class="keywordtype">void</span> <a id="a23" name="a23"></a><a class="code hl_function" href="classDiffusion.html#a46b50c0264b591fc328fd84a564b1e62">allocate</a>() {</div>
<div class="line">    <span class="keywordflow">if</span> (<a class="code hl_function" href="classpfc_1_1Model.html#adcf94d7a4a1351b513bacd1860762f9c">is_rank0</a>()) std::cout &lt;&lt; <span class="stringliteral">&quot;Allocate space&quot;</span> &lt;&lt; std::endl;</div>
<div class="line">    <a id="_a24" name="_a24"></a><a class="code hl_class" href="classpfc_1_1FFT.html">FFT</a> &amp;<a id="a25" name="a25"></a><a class="code hl_function" href="mpi__timers_8cpp.html#a3a49057ffba576f4b5efe09f8a175879">fft</a> = <a id="a26" name="a26"></a><a class="code hl_function" href="classpfc_1_1Model.html#a06a03a46398d52a3a3afb7490d3e1c41">get_fft</a>();</div>
<div class="line">    psi.resize(<a class="code hl_function" href="mpi__timers_8cpp.html#a3a49057ffba576f4b5efe09f8a175879">fft</a>.size_inbox());</div>
<div class="line">    psi_F.resize(<a class="code hl_function" href="mpi__timers_8cpp.html#a3a49057ffba576f4b5efe09f8a175879">fft</a>.size_outbox());</div>
<div class="line">    opL.resize(<a class="code hl_function" href="mpi__timers_8cpp.html#a3a49057ffba576f4b5efe09f8a175879">fft</a>.size_outbox());</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// &quot;Register&quot; real field psi with a name &quot;psi&quot; so that we can access it from</span></div>
<div class="line">    <span class="comment">// initial condition.</span></div>
<div class="line">    <a id="a27" name="a27"></a><a class="code hl_function" href="classpfc_1_1Model.html#a5e2da3dc9b8c277fa708189a0d4de563">add_real_field</a>(<span class="stringliteral">&quot;psi&quot;</span>, psi);</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <span class="keywordtype">void</span> <a id="a28" name="a28"></a><a class="code hl_function" href="classDiffusion.html#ad1ff34a303cba2dc727be2b99455bb77">prepare_operators</a>(<span class="keywordtype">double</span> dt) {</div>
<div class="line">    <span class="keyword">const</span> <a class="code hl_class" href="classpfc_1_1World.html">World</a> &amp;w = <a class="code hl_function" href="classpfc_1_1Model.html#ac60d580e7e9ce3a268414f92131a95e1">get_world</a>();</div>
<div class="line">    <span class="keyword">const</span> <a class="code hl_class" href="classpfc_1_1Decomposition.html">Decomposition</a> &amp;decomp = <a class="code hl_function" href="classpfc_1_1Model.html#a114dbe9ce04ba6e719e232dea52d4313">get_decomposition</a>();</div>
<div class="line">    std::array&lt;int, 3&gt; low = decomp.<a id="a29" name="a29"></a><a class="code hl_variable" href="classpfc_1_1Decomposition.html#a04df6a82361a68e5ac36808259997f5d">outbox</a>.low;</div>
<div class="line">    std::array&lt;int, 3&gt; high = decomp.<a class="code hl_variable" href="classpfc_1_1Decomposition.html#a04df6a82361a68e5ac36808259997f5d">outbox</a>.high;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (<a class="code hl_function" href="classpfc_1_1Model.html#adcf94d7a4a1351b513bacd1860762f9c">is_rank0</a>()) std::cout &lt;&lt; <span class="stringliteral">&quot;Prepare operators&quot;</span> &lt;&lt; std::endl;</div>
<div class="line">    <span class="keywordtype">size_t</span> idx = 0;</div>
<div class="line">    <span class="keywordtype">double</span> fx = 2.0 * <a class="code hl_variable" href="05__simulator_8cpp.html#a952eac791b596a61bba0a133a3bb439f">PI</a> / (w.<a class="code hl_variable" href="classpfc_1_1World.html#a78728443e7c39c89da0a919fcdb584df">dx</a> * w.<a id="a30" name="a30"></a><a class="code hl_variable" href="classpfc_1_1World.html#af816f40f453aaf1b91a339fbc982ed8b">Lx</a>);</div>
<div class="line">    <span class="keywordtype">double</span> fy = 2.0 * <a class="code hl_variable" href="05__simulator_8cpp.html#a952eac791b596a61bba0a133a3bb439f">PI</a> / (w.<a class="code hl_variable" href="classpfc_1_1World.html#a07404e069e3188e737c45964446dec49">dy</a> * w.<a id="a31" name="a31"></a><a class="code hl_variable" href="classpfc_1_1World.html#ab0b0ef4d407bcdb3247e3d98884e0434">Ly</a>);</div>
<div class="line">    <span class="keywordtype">double</span> fz = 2.0 * <a class="code hl_variable" href="05__simulator_8cpp.html#a952eac791b596a61bba0a133a3bb439f">PI</a> / (w.<a class="code hl_variable" href="classpfc_1_1World.html#aefac04e64d4287f792ecb22e7f0f3c2f">dz</a> * w.<a id="a32" name="a32"></a><a class="code hl_variable" href="classpfc_1_1World.html#af70f18f705556771f40034b03fc3a239">Lz</a>);</div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = low[2]; k &lt;= high[2]; k++) {</div>
<div class="line">      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = low[1]; j &lt;= high[1]; j++) {</div>
<div class="line">        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = low[0]; i &lt;= high[0]; i++) {</div>
<div class="line">          <span class="comment">// Laplacian operator -k^2</span></div>
<div class="line">          <span class="keywordtype">double</span> ki = (i &lt;= w.<a class="code hl_variable" href="classpfc_1_1World.html#af816f40f453aaf1b91a339fbc982ed8b">Lx</a> / 2) ? i * fx : (i - w.Lx) * fx;</div>
<div class="line">          <span class="keywordtype">double</span> kj = (j &lt;= w.<a class="code hl_variable" href="classpfc_1_1World.html#ab0b0ef4d407bcdb3247e3d98884e0434">Ly</a> / 2) ? j * fy : (j - w.Ly) * fy;</div>
<div class="line">          <span class="keywordtype">double</span> kk = (k &lt;= w.<a class="code hl_variable" href="classpfc_1_1World.html#af70f18f705556771f40034b03fc3a239">Lz</a> / 2) ? k * fz : (k - w.Lz) * fz;</div>
<div class="line">          <span class="keywordtype">double</span> kLap = -(ki * ki + kj * kj + kk * kk);</div>
<div class="line">          opL[idx++] = 1.0 / (1.0 - dt * kLap);</div>
<div class="line">        }</div>
<div class="line">      }</div>
<div class="line">    }</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <span class="keywordtype">void</span> <a id="a33" name="a33"></a><a class="code hl_function" href="classDiffusion.html#a3f3e65a63f5919d13a4aed39c2ed406f">initialize</a>(<span class="keywordtype">double</span> dt)<span class="keyword"> override </span>{</div>
<div class="line">    <a class="code hl_function" href="classDiffusion.html#a46b50c0264b591fc328fd84a564b1e62">allocate</a>();</div>
<div class="line">    <a class="code hl_function" href="classDiffusion.html#ad1ff34a303cba2dc727be2b99455bb77">prepare_operators</a>(dt);</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <span class="keywordtype">void</span> <a id="a34" name="a34"></a><a class="code hl_function" href="classDiffusion.html#ad85cf4e5efd5b48c340b48befc994f82">step</a>(<span class="keywordtype">double</span>)<span class="keyword"> override </span>{</div>
<div class="line">    <a class="code hl_class" href="classpfc_1_1FFT.html">FFT</a> &amp;<a class="code hl_function" href="mpi__timers_8cpp.html#a3a49057ffba576f4b5efe09f8a175879">fft</a> = <a class="code hl_function" href="classpfc_1_1Model.html#a06a03a46398d52a3a3afb7490d3e1c41">get_fft</a>();</div>
<div class="line">    <a class="code hl_function" href="mpi__timers_8cpp.html#a3a49057ffba576f4b5efe09f8a175879">fft</a>.forward(psi, psi_F);</div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 0, N = psi_F.size(); k &lt; N; k++) psi_F[k] = opL[k] * psi_F[k];</div>
<div class="line">    <a class="code hl_function" href="mpi__timers_8cpp.html#a3a49057ffba576f4b5efe09f8a175879">fft</a>.backward(psi_F, psi);</div>
<div class="line">    <a id="a35" name="a35"></a><a class="code hl_function" href="classDiffusion.html#af70b504576a9082c7e73abce7b4398c7">find_minmax</a>();</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <span class="keywordtype">void</span> <a class="code hl_function" href="classDiffusion.html#af70b504576a9082c7e73abce7b4398c7">find_minmax</a>() {</div>
<div class="line">    <span class="keywordtype">double</span> local_min = std::numeric_limits&lt;double&gt;::max();</div>
<div class="line">    <span class="keywordtype">double</span> local_max = std::numeric_limits&lt;double&gt;::min();</div>
<div class="line">    <span class="keyword">auto</span> min_max_finder = [&amp;local_min, &amp;local_max](<span class="keyword">const</span> <span class="keywordtype">double</span> &amp;value) {</div>
<div class="line">      local_min = std::min(local_min, value);</div>
<div class="line">      local_max = std::max(local_max, value);</div>
<div class="line">    };</div>
<div class="line">    std::for_each(psi.begin(), psi.end(), min_max_finder);</div>
<div class="line">    MPI_Reduce(&amp;local_min, &amp;<a class="code hl_variable" href="classDiffusion.html#a6ad3de2af17be6a8bd02984e44eeae52">psi_min</a>, 1, MPI_DOUBLE, MPI_MIN, 0, MPI_COMM_WORLD);</div>
<div class="line">    MPI_Reduce(&amp;local_max, &amp;<a class="code hl_variable" href="classDiffusion.html#ac1d50c7d6399f40c5ded1f6cb18101c7">psi_max</a>, 1, MPI_DOUBLE, MPI_MAX, 0, MPI_COMM_WORLD);</div>
<div class="line">  }</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">void</span> <a id="a36" name="a36"></a><a class="code hl_function" href="05__simulator_8cpp.html#aba53d051734cd1be53b6ba37d267f086">print_statline</a>(<a id="_a37" name="_a37"></a><a class="code hl_class" href="classpfc_1_1Simulator.html">Simulator</a> &amp;s) {</div>
<div class="line">  <span class="keywordflow">if</span> (!s.<a id="a38" name="a38"></a><a class="code hl_function" href="classpfc_1_1Simulator.html#aa808580b0d4ea99afb990c0122dc3e70">is_rank0</a>()) <span class="keywordflow">return</span>;</div>
<div class="line">  <span class="keywordtype">int</span> n = s.<a id="a39" name="a39"></a><a class="code hl_function" href="classpfc_1_1Simulator.html#a6731ec79218b5a628f926b19f42bb953">get_increment</a>();</div>
<div class="line">  <span class="keywordtype">double</span> t = s.<a id="a40" name="a40"></a><a class="code hl_function" href="classpfc_1_1Simulator.html#a8fb1bf1abbf09f8dc165f0dcae1c14d7">get_time</a>();</div>
<div class="line">  <a class="code hl_class" href="classpfc_1_1Model.html">Model</a> &amp;model = s.<a id="a41" name="a41"></a><a class="code hl_function" href="classpfc_1_1Simulator.html#a83983bfa86b3c5dc132de39503e6b7da">get_model</a>();</div>
<div class="line">  <a class="code hl_class" href="classDiffusion.html">Diffusion</a> &amp;diffusion_model = <span class="keyword">dynamic_cast&lt;</span><a class="code hl_class" href="classDiffusion.html">Diffusion</a> &amp;<span class="keyword">&gt;</span>(model);</div>
<div class="line">  <span class="keywordtype">double</span> min = diffusion_model.<a class="code hl_function" href="classDiffusion.html#aeb47728c34eb1ec81b4ab30e02ca156a">get_psi_min</a>();</div>
<div class="line">  <span class="keywordtype">double</span> max = diffusion_model.<a class="code hl_function" href="classDiffusion.html#ad4262b0cb5f4db417674f9915c43ee48">get_psi_max</a>();</div>
<div class="line">  std::cout &lt;&lt; <span class="stringliteral">&quot;n = &quot;</span> &lt;&lt; n &lt;&lt; <span class="stringliteral">&quot;, t = &quot;</span> &lt;&lt; t &lt;&lt; <span class="stringliteral">&quot;, min = &quot;</span> &lt;&lt; min &lt;&lt; <span class="stringliteral">&quot;, max = &quot;</span> &lt;&lt; max &lt;&lt; std::endl;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">void</span> <a id="a42" name="a42"></a><a class="code hl_function" href="05__simulator_8cpp.html#ac9aa23c972ec106174145e4e3602b629">run_simulator</a>(<a class="code hl_class" href="classpfc_1_1Simulator.html">Simulator</a> &amp;s) {</div>
<div class="line">  <span class="comment">// Initialize the simulator before starting time stepping.</span></div>
<div class="line">  <span class="comment">// This also initializes model.</span></div>
<div class="line">  s.<a id="a43" name="a43"></a><a class="code hl_function" href="classpfc_1_1Simulator.html#ae65850c6eafa9fef8d259b40eef52c36">initialize</a>();</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Run the simulator until we are done</span></div>
<div class="line">  <a class="code hl_function" href="05__simulator_8cpp.html#aba53d051734cd1be53b6ba37d267f086">print_statline</a>(s);</div>
<div class="line">  <span class="keywordflow">while</span> (!s.<a id="a44" name="a44"></a><a class="code hl_function" href="classpfc_1_1Simulator.html#a6326d795bb2e652c77acd762819b477f">done</a>()) {</div>
<div class="line">    s.<a id="a45" name="a45"></a><a class="code hl_function" href="classpfc_1_1Simulator.html#ac1d319e50c9bf09b4ec5840b296d0dd2">step</a>();</div>
<div class="line">    <a class="code hl_function" href="05__simulator_8cpp.html#aba53d051734cd1be53b6ba37d267f086">print_statline</a>(s);</div>
<div class="line">  }</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">void</span> <a id="a46" name="a46"></a><a class="code hl_function" href="04__diffusion__model_8cpp.html#a13a43e6d814de94978c515cb084873b1">run</a>() {</div>
<div class="line">  <span class="comment">// Construct world, decomposition, fft and model</span></div>
<div class="line">  <span class="keywordtype">int</span> L = 64;</div>
<div class="line">  <span class="keywordtype">double</span> h = 2.0 * <a class="code hl_variable" href="05__simulator_8cpp.html#a952eac791b596a61bba0a133a3bb439f">PI</a> / 8.0;</div>
<div class="line">  <span class="keywordtype">double</span> o = -0.5 * L * h;</div>
<div class="line">  std::array&lt;int, 3&gt; dimensions = {L, L, L};</div>
<div class="line">  std::array&lt;double, 3&gt; discretization = {h, h, h};</div>
<div class="line">  std::array&lt;double, 3&gt; origin = {o, o, o};</div>
<div class="line">  <a class="code hl_class" href="classpfc_1_1World.html">World</a> world(dimensions, origin, discretization);</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_class" href="classpfc_1_1Decomposition.html">Decomposition</a> decomp(world);</div>
<div class="line">  <a class="code hl_class" href="classpfc_1_1FFT.html">FFT</a> <a class="code hl_function" href="mpi__timers_8cpp.html#a3a49057ffba576f4b5efe09f8a175879">fft</a>(decomp);</div>
<div class="line">  <a class="code hl_class" href="classDiffusion.html">Diffusion</a> model(<a class="code hl_function" href="mpi__timers_8cpp.html#a3a49057ffba576f4b5efe09f8a175879">fft</a>);</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Define time</span></div>
<div class="line">  <span class="keywordtype">double</span> t0 = 0.0;</div>
<div class="line">  <span class="keywordtype">double</span> t1 = 0.5874010519681994;</div>
<div class="line">  <span class="keywordtype">double</span> dt = (t1 - t0) / 42;</div>
<div class="line">  <span class="keywordtype">double</span> saveat = dt; <span class="comment">// when to save results</span></div>
<div class="line">  std::array&lt;double, 3&gt; tspan{t0, t1, dt};</div>
<div class="line">  <a id="_a47" name="_a47"></a><a class="code hl_class" href="classpfc_1_1Time.html">Time</a> time(tspan, saveat);</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Define simulator</span></div>
<div class="line">  <a class="code hl_class" href="classpfc_1_1Simulator.html">Simulator</a> simulator(model, time);</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Define initial condition and add it to simulator</span></div>
<div class="line">  simulator.add_initial_conditions(std::make_unique&lt;GaussianIC&gt;());</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_function" href="05__simulator_8cpp.html#ac9aa23c972ec106174145e4e3602b629">run_simulator</a>(simulator);</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Check the result, we should be very close to 0.5</span></div>
<div class="line">  <span class="keywordflow">if</span> (model.<a id="a48" name="a48"></a><a class="code hl_variable" href="classpfc_1_1Model.html#ade57ace089ccbd4a2a07af3a74aa49d7">rank0</a>) {</div>
<div class="line">    <span class="keywordflow">if</span> (std::abs(model.get_psi_max() - 0.5) &lt; 0.01) {</div>
<div class="line">      std::cout &lt;&lt; <span class="stringliteral">&quot;Test pass!&quot;</span> &lt;&lt; std::endl;</div>
<div class="line">    } <span class="keywordflow">else</span> {</div>
<div class="line">      std::cerr &lt;&lt; <span class="stringliteral">&quot;Test failed!&quot;</span> &lt;&lt; std::endl;</div>
<div class="line">    }</div>
<div class="line">  }</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">int</span> <a id="a49" name="a49"></a><a class="code hl_function" href="01__hello__world_8cpp.html#ae66f6b31b5ad750f1fe042a706a4e3d4">main</a>(<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span> *argv[]) {</div>
<div class="line">  std::cout &lt;&lt; std::fixed;</div>
<div class="line">  std::cout.precision(12);</div>
<div class="line">  MPI_Init(&amp;argc, &amp;argv);</div>
<div class="line">  <a class="code hl_function" href="04__diffusion__model_8cpp.html#a13a43e6d814de94978c515cb084873b1">run</a>();</div>
<div class="line">  MPI_Finalize();</div>
<div class="line">}</div>
<div class="ttc" id="a01__hello__world_8cpp_html_ae66f6b31b5ad750f1fe042a706a4e3d4"><div class="ttname"><a href="01__hello__world_8cpp.html#ae66f6b31b5ad750f1fe042a706a4e3d4">main</a></div><div class="ttdeci">int main()</div><div class="ttdef"><b>Definition</b> 01_hello_world.cpp:30</div></div>
<div class="ttc" id="a04__diffusion__model_8cpp_html_a13a43e6d814de94978c515cb084873b1"><div class="ttname"><a href="04__diffusion__model_8cpp.html#a13a43e6d814de94978c515cb084873b1">run</a></div><div class="ttdeci">void run()</div><div class="ttdef"><b>Definition</b> 04_diffusion_model.cpp:211</div></div>
<div class="ttc" id="a05__simulator_8cpp_html_a952eac791b596a61bba0a133a3bb439f"><div class="ttname"><a href="05__simulator_8cpp.html#a952eac791b596a61bba0a133a3bb439f">PI</a></div><div class="ttdeci">const double PI</div><div class="ttdef"><b>Definition</b> 05_simulator.cpp:39</div></div>
<div class="ttc" id="a05__simulator_8cpp_html_aba53d051734cd1be53b6ba37d267f086"><div class="ttname"><a href="05__simulator_8cpp.html#aba53d051734cd1be53b6ba37d267f086">print_statline</a></div><div class="ttdeci">void print_statline(Simulator &amp;s)</div><div class="ttdef"><b>Definition</b> 05_simulator.cpp:145</div></div>
<div class="ttc" id="a05__simulator_8cpp_html_ac9aa23c972ec106174145e4e3602b629"><div class="ttname"><a href="05__simulator_8cpp.html#ac9aa23c972ec106174145e4e3602b629">run_simulator</a></div><div class="ttdeci">void run_simulator(Simulator &amp;s)</div><div class="ttdef"><b>Definition</b> 05_simulator.cpp:156</div></div>
<div class="ttc" id="aclassDiffusion_html"><div class="ttname"><a href="classDiffusion.html">Diffusion</a></div><div class="ttdef"><b>Definition</b> 04_diffusion_model.cpp:59</div></div>
<div class="ttc" id="aclassDiffusion_html_a3f3e65a63f5919d13a4aed39c2ed406f"><div class="ttname"><a href="classDiffusion.html#a3f3e65a63f5919d13a4aed39c2ed406f">Diffusion::initialize</a></div><div class="ttdeci">void initialize(double dt) override</div><div class="ttdoc">Initialize the diffusion model.</div><div class="ttdef"><b>Definition</b> 04_diffusion_model.cpp:78</div></div>
<div class="ttc" id="aclassDiffusion_html_a46b50c0264b591fc328fd84a564b1e62"><div class="ttname"><a href="classDiffusion.html#a46b50c0264b591fc328fd84a564b1e62">Diffusion::allocate</a></div><div class="ttdeci">void allocate()</div><div class="ttdef"><b>Definition</b> 05_simulator.cpp:82</div></div>
<div class="ttc" id="aclassDiffusion_html_a6ad3de2af17be6a8bd02984e44eeae52"><div class="ttname"><a href="classDiffusion.html#a6ad3de2af17be6a8bd02984e44eeae52">Diffusion::psi_min</a></div><div class="ttdeci">double psi_min</div><div class="ttdef"><b>Definition</b> 04_diffusion_model.cpp:67</div></div>
<div class="ttc" id="aclassDiffusion_html_ac1d50c7d6399f40c5ded1f6cb18101c7"><div class="ttname"><a href="classDiffusion.html#ac1d50c7d6399f40c5ded1f6cb18101c7">Diffusion::psi_max</a></div><div class="ttdeci">double psi_max</div><div class="ttdef"><b>Definition</b> 04_diffusion_model.cpp:67</div></div>
<div class="ttc" id="aclassDiffusion_html_ad1ff34a303cba2dc727be2b99455bb77"><div class="ttname"><a href="classDiffusion.html#ad1ff34a303cba2dc727be2b99455bb77">Diffusion::prepare_operators</a></div><div class="ttdeci">void prepare_operators(double dt)</div><div class="ttdef"><b>Definition</b> 05_simulator.cpp:94</div></div>
<div class="ttc" id="aclassDiffusion_html_ad4262b0cb5f4db417674f9915c43ee48"><div class="ttname"><a href="classDiffusion.html#ad4262b0cb5f4db417674f9915c43ee48">Diffusion::get_psi_max</a></div><div class="ttdeci">double get_psi_max() const</div><div class="ttdef"><b>Definition</b> 05_simulator.cpp:80</div></div>
<div class="ttc" id="aclassDiffusion_html_ad85cf4e5efd5b48c340b48befc994f82"><div class="ttname"><a href="classDiffusion.html#ad85cf4e5efd5b48c340b48befc994f82">Diffusion::step</a></div><div class="ttdeci">void step(double) override</div><div class="ttdoc">The actual time stepping function.</div><div class="ttdef"><b>Definition</b> 04_diffusion_model.cpp:166</div></div>
<div class="ttc" id="aclassDiffusion_html_aeb47728c34eb1ec81b4ab30e02ca156a"><div class="ttname"><a href="classDiffusion.html#aeb47728c34eb1ec81b4ab30e02ca156a">Diffusion::get_psi_min</a></div><div class="ttdeci">double get_psi_min() const</div><div class="ttdef"><b>Definition</b> 05_simulator.cpp:79</div></div>
<div class="ttc" id="aclassDiffusion_html_af70b504576a9082c7e73abce7b4398c7"><div class="ttname"><a href="classDiffusion.html#af70b504576a9082c7e73abce7b4398c7">Diffusion::find_minmax</a></div><div class="ttdeci">void find_minmax()</div><div class="ttdoc">A simple MPI communication example.</div><div class="ttdef"><b>Definition</b> 04_diffusion_model.cpp:182</div></div>
<div class="ttc" id="aclassGaussianIC_html"><div class="ttname"><a href="classGaussianIC.html">GaussianIC</a></div><div class="ttdef"><b>Definition</b> 05_simulator.cpp:41</div></div>
<div class="ttc" id="aclassGaussianIC_html_a2904703e53544be07ff7f2131ed82230"><div class="ttname"><a href="classGaussianIC.html#a2904703e53544be07ff7f2131ed82230">GaussianIC::apply</a></div><div class="ttdeci">void apply(Model &amp;m, double t) override</div><div class="ttdoc">Apply the field modification to the model at a specific time.</div><div class="ttdef"><b>Definition</b> 05_simulator.cpp:46</div></div>
<div class="ttc" id="aclasspfc_1_1Decomposition_html"><div class="ttname"><a href="classpfc_1_1Decomposition.html">pfc::Decomposition</a></div><div class="ttdoc">Class representing the domain decomposition for parallel Fast Fourier Transform.</div><div class="ttdef"><b>Definition</b> decomposition.hpp:20</div></div>
<div class="ttc" id="aclasspfc_1_1Decomposition_html_a04df6a82361a68e5ac36808259997f5d"><div class="ttname"><a href="classpfc_1_1Decomposition.html#a04df6a82361a68e5ac36808259997f5d">pfc::Decomposition::outbox</a></div><div class="ttdeci">const heffte::box3d&lt; int &gt; outbox</div><div class="ttdoc">Local communication boxes.</div><div class="ttdef"><b>Definition</b> decomposition.hpp:52</div></div>
<div class="ttc" id="aclasspfc_1_1Decomposition_html_a78a2cd4304a8a69665c3b24503ff8c73"><div class="ttname"><a href="classpfc_1_1Decomposition.html#a78a2cd4304a8a69665c3b24503ff8c73">pfc::Decomposition::inbox</a></div><div class="ttdeci">const heffte::box3d&lt; int &gt; inbox</div><div class="ttdef"><b>Definition</b> decomposition.hpp:52</div></div>
<div class="ttc" id="aclasspfc_1_1FFT_html"><div class="ttname"><a href="classpfc_1_1FFT.html">pfc::FFT</a></div><div class="ttdoc">FFT class for performing forward and backward Fast Fourier Transformations.</div><div class="ttdef"><b>Definition</b> fft.hpp:15</div></div>
<div class="ttc" id="aclasspfc_1_1FieldModifier_html"><div class="ttname"><a href="classpfc_1_1FieldModifier.html">pfc::FieldModifier</a></div><div class="ttdoc">The FieldModifier class represents a base class for field modifiers in PFC.</div><div class="ttdef"><b>Definition</b> field_modifier.hpp:13</div></div>
<div class="ttc" id="aclasspfc_1_1Model_html"><div class="ttname"><a href="classpfc_1_1Model.html">pfc::Model</a></div><div class="ttdoc">The Model class represents the physics model for simulations in OpenPFC.</div><div class="ttdef"><b>Definition</b> model.hpp:30</div></div>
<div class="ttc" id="aclasspfc_1_1Model_html_a06a03a46398d52a3a3afb7490d3e1c41"><div class="ttname"><a href="classpfc_1_1Model.html#a06a03a46398d52a3a3afb7490d3e1c41">pfc::Model::get_fft</a></div><div class="ttdeci">FFT &amp; get_fft()</div><div class="ttdoc">Get the FFT object associated with the model.</div><div class="ttdef"><b>Definition</b> model.hpp:90</div></div>
<div class="ttc" id="aclasspfc_1_1Model_html_a114dbe9ce04ba6e719e232dea52d4313"><div class="ttname"><a href="classpfc_1_1Model.html#a114dbe9ce04ba6e719e232dea52d4313">pfc::Model::get_decomposition</a></div><div class="ttdeci">const Decomposition &amp; get_decomposition()</div><div class="ttdoc">Get the decomposition object associated with the model.</div><div class="ttdef"><b>Definition</b> model.hpp:66</div></div>
<div class="ttc" id="aclasspfc_1_1Model_html_a3388b9c18e0dc205cc15f1392e5c8f4b"><div class="ttname"><a href="classpfc_1_1Model.html#a3388b9c18e0dc205cc15f1392e5c8f4b">pfc::Model::get_real_field</a></div><div class="ttdeci">RealField &amp; get_real_field(const std::string &amp;name)</div><div class="ttdoc">Get a reference to the real-valued field with the given name.</div><div class="ttdef"><b>Definition</b> model.hpp:158</div></div>
<div class="ttc" id="aclasspfc_1_1Model_html_a5e2da3dc9b8c277fa708189a0d4de563"><div class="ttname"><a href="classpfc_1_1Model.html#a5e2da3dc9b8c277fa708189a0d4de563">pfc::Model::add_real_field</a></div><div class="ttdeci">void add_real_field(const std::string &amp;name, RealField &amp;field)</div><div class="ttdoc">Add a real-valued field to the model.</div><div class="ttdef"><b>Definition</b> model.hpp:134</div></div>
<div class="ttc" id="aclasspfc_1_1Model_html_ac60d580e7e9ce3a268414f92131a95e1"><div class="ttname"><a href="classpfc_1_1Model.html#ac60d580e7e9ce3a268414f92131a95e1">pfc::Model::get_world</a></div><div class="ttdeci">const World &amp; get_world()</div><div class="ttdoc">Get the world object associated with the model.</div><div class="ttdef"><b>Definition</b> model.hpp:73</div></div>
<div class="ttc" id="aclasspfc_1_1Model_html_adcf94d7a4a1351b513bacd1860762f9c"><div class="ttname"><a href="classpfc_1_1Model.html#adcf94d7a4a1351b513bacd1860762f9c">pfc::Model::is_rank0</a></div><div class="ttdeci">bool is_rank0()</div><div class="ttdoc">Return boolean flag indicating is this process rank 0.</div><div class="ttdef"><b>Definition</b> model.hpp:59</div></div>
<div class="ttc" id="aclasspfc_1_1Model_html_ade57ace089ccbd4a2a07af3a74aa49d7"><div class="ttname"><a href="classpfc_1_1Model.html#ade57ace089ccbd4a2a07af3a74aa49d7">pfc::Model::rank0</a></div><div class="ttdeci">bool rank0</div><div class="ttdef"><b>Definition</b> model.hpp:39</div></div>
<div class="ttc" id="aclasspfc_1_1Simulator_html"><div class="ttname"><a href="classpfc_1_1Simulator.html">pfc::Simulator</a></div><div class="ttdef"><b>Definition</b> simulator.hpp:14</div></div>
<div class="ttc" id="aclasspfc_1_1Simulator_html_a6326d795bb2e652c77acd762819b477f"><div class="ttname"><a href="classpfc_1_1Simulator.html#a6326d795bb2e652c77acd762819b477f">pfc::Simulator::done</a></div><div class="ttdeci">bool done()</div><div class="ttdef"><b>Definition</b> simulator.hpp:131</div></div>
<div class="ttc" id="aclasspfc_1_1Simulator_html_a6731ec79218b5a628f926b19f42bb953"><div class="ttname"><a href="classpfc_1_1Simulator.html#a6731ec79218b5a628f926b19f42bb953">pfc::Simulator::get_increment</a></div><div class="ttdeci">unsigned int get_increment()</div><div class="ttdef"><b>Definition</b> simulator.hpp:46</div></div>
<div class="ttc" id="aclasspfc_1_1Simulator_html_a83983bfa86b3c5dc132de39503e6b7da"><div class="ttname"><a href="classpfc_1_1Simulator.html#a83983bfa86b3c5dc132de39503e6b7da">pfc::Simulator::get_model</a></div><div class="ttdeci">Model &amp; get_model()</div><div class="ttdef"><b>Definition</b> simulator.hpp:29</div></div>
<div class="ttc" id="aclasspfc_1_1Simulator_html_a8fb1bf1abbf09f8dc165f0dcae1c14d7"><div class="ttname"><a href="classpfc_1_1Simulator.html#a8fb1bf1abbf09f8dc165f0dcae1c14d7">pfc::Simulator::get_time</a></div><div class="ttdeci">Time &amp; get_time()</div><div class="ttdef"><b>Definition</b> simulator.hpp:35</div></div>
<div class="ttc" id="aclasspfc_1_1Simulator_html_aa808580b0d4ea99afb990c0122dc3e70"><div class="ttname"><a href="classpfc_1_1Simulator.html#aa808580b0d4ea99afb990c0122dc3e70">pfc::Simulator::is_rank0</a></div><div class="ttdeci">bool is_rank0()</div><div class="ttdef"><b>Definition</b> simulator.hpp:42</div></div>
<div class="ttc" id="aclasspfc_1_1Simulator_html_ac1d319e50c9bf09b4ec5840b296d0dd2"><div class="ttname"><a href="classpfc_1_1Simulator.html#ac1d319e50c9bf09b4ec5840b296d0dd2">pfc::Simulator::step</a></div><div class="ttdeci">void step()</div><div class="ttdef"><b>Definition</b> simulator.hpp:112</div></div>
<div class="ttc" id="aclasspfc_1_1Simulator_html_ae65850c6eafa9fef8d259b40eef52c36"><div class="ttname"><a href="classpfc_1_1Simulator.html#ae65850c6eafa9fef8d259b40eef52c36">pfc::Simulator::initialize</a></div><div class="ttdeci">void initialize()</div><div class="ttdef"><b>Definition</b> simulator.hpp:38</div></div>
<div class="ttc" id="aclasspfc_1_1Time_html"><div class="ttname"><a href="classpfc_1_1Time.html">pfc::Time</a></div><div class="ttdoc">The Time class represents a time interval for simulations in PFC.</div><div class="ttdef"><b>Definition</b> time.hpp:18</div></div>
<div class="ttc" id="aclasspfc_1_1World_html"><div class="ttname"><a href="classpfc_1_1World.html">pfc::World</a></div><div class="ttdoc">Represents a world in the simulation domain.</div><div class="ttdef"><b>Definition</b> world.hpp:27</div></div>
<div class="ttc" id="aclasspfc_1_1World_html_a07404e069e3188e737c45964446dec49"><div class="ttname"><a href="classpfc_1_1World.html#a07404e069e3188e737c45964446dec49">pfc::World::dy</a></div><div class="ttdeci">const double dy</div><div class="ttdoc">Discretization parameter in the y-direction.</div><div class="ttdef"><b>Definition</b> world.hpp:38</div></div>
<div class="ttc" id="aclasspfc_1_1World_html_a4a5f1f99377c9ad310c15bfeba8c7fee"><div class="ttname"><a href="classpfc_1_1World.html#a4a5f1f99377c9ad310c15bfeba8c7fee">pfc::World::z0</a></div><div class="ttdeci">const double z0</div><div class="ttdoc">Origin coordinate in the z-direction.</div><div class="ttdef"><b>Definition</b> world.hpp:36</div></div>
<div class="ttc" id="aclasspfc_1_1World_html_a78728443e7c39c89da0a919fcdb584df"><div class="ttname"><a href="classpfc_1_1World.html#a78728443e7c39c89da0a919fcdb584df">pfc::World::dx</a></div><div class="ttdeci">const double dx</div><div class="ttdoc">Discretization parameter in the x-direction.</div><div class="ttdef"><b>Definition</b> world.hpp:37</div></div>
<div class="ttc" id="aclasspfc_1_1World_html_ab0b0ef4d407bcdb3247e3d98884e0434"><div class="ttname"><a href="classpfc_1_1World.html#ab0b0ef4d407bcdb3247e3d98884e0434">pfc::World::Ly</a></div><div class="ttdeci">const int Ly</div><div class="ttdoc">Length in the y-direction.</div><div class="ttdef"><b>Definition</b> world.hpp:32</div></div>
<div class="ttc" id="aclasspfc_1_1World_html_acc6ffdae16ec121877b6b52eb4d20b6e"><div class="ttname"><a href="classpfc_1_1World.html#acc6ffdae16ec121877b6b52eb4d20b6e">pfc::World::x0</a></div><div class="ttdeci">const double x0</div><div class="ttdoc">Origin coordinate in the x-direction.</div><div class="ttdef"><b>Definition</b> world.hpp:34</div></div>
<div class="ttc" id="aclasspfc_1_1World_html_aefac04e64d4287f792ecb22e7f0f3c2f"><div class="ttname"><a href="classpfc_1_1World.html#aefac04e64d4287f792ecb22e7f0f3c2f">pfc::World::dz</a></div><div class="ttdeci">const double dz</div><div class="ttdoc">Discretization parameter in the z-direction.</div><div class="ttdef"><b>Definition</b> world.hpp:39</div></div>
<div class="ttc" id="aclasspfc_1_1World_html_af70d91e76a70f703b84394a8f58df90d"><div class="ttname"><a href="classpfc_1_1World.html#af70d91e76a70f703b84394a8f58df90d">pfc::World::y0</a></div><div class="ttdeci">const double y0</div><div class="ttdoc">Origin coordinate in the y-direction.</div><div class="ttdef"><b>Definition</b> world.hpp:35</div></div>
<div class="ttc" id="aclasspfc_1_1World_html_af70f18f705556771f40034b03fc3a239"><div class="ttname"><a href="classpfc_1_1World.html#af70f18f705556771f40034b03fc3a239">pfc::World::Lz</a></div><div class="ttdeci">const int Lz</div><div class="ttdoc">Length in the z-direction.</div><div class="ttdef"><b>Definition</b> world.hpp:33</div></div>
<div class="ttc" id="aclasspfc_1_1World_html_af816f40f453aaf1b91a339fbc982ed8b"><div class="ttname"><a href="classpfc_1_1World.html#af816f40f453aaf1b91a339fbc982ed8b">pfc::World::Lx</a></div><div class="ttdeci">const int Lx</div><div class="ttdoc">Length in the x-direction.</div><div class="ttdef"><b>Definition</b> world.hpp:31</div></div>
<div class="ttc" id="adecomposition_8hpp_html"><div class="ttname"><a href="decomposition_8hpp.html">decomposition.hpp</a></div></div>
<div class="ttc" id="afft_8hpp_html"><div class="ttname"><a href="fft_8hpp.html">fft.hpp</a></div></div>
<div class="ttc" id="afield__modifier_8hpp_html"><div class="ttname"><a href="field__modifier_8hpp.html">field_modifier.hpp</a></div></div>
<div class="ttc" id="amodel_8hpp_html"><div class="ttname"><a href="model_8hpp.html">model.hpp</a></div></div>
<div class="ttc" id="ampi__timers_8cpp_html_a3a49057ffba576f4b5efe09f8a175879"><div class="ttname"><a href="mpi__timers_8cpp.html#a3a49057ffba576f4b5efe09f8a175879">fft</a></div><div class="ttdeci">void fft()</div><div class="ttdef"><b>Definition</b> mpi_timers.cpp:6</div></div>
<div class="ttc" id="anamespacepfc_html"><div class="ttname"><a href="namespacepfc.html">pfc</a></div><div class="ttdef"><b>Definition</b> array.hpp:18</div></div>
<div class="ttc" id="asimulator_8hpp_html"><div class="ttname"><a href="simulator_8hpp.html">simulator.hpp</a></div></div>
<div class="ttc" id="aworld_8hpp_html"><div class="ttname"><a href="world_8hpp.html">world.hpp</a></div></div>
</div><!-- fragment --> </div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.7 </li>
  </ul>
</div>
</body>
</html>
