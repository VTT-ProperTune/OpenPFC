{
    "$schema": "http://json-schema.org/draft-07/schema#",
    "$id": "http://openpfc.github.io/schema.json",
    "title": "Application schema",
    "description": "Application schema",
    "type": "object",
    "properties": {
        "model": {
            "type": "object",
            "oneOf": [
                {
                    "$ref": "#/definitions/models/tungsten"
                },
                {
                    "$ref": "#/definitions/models/aluminum"
                }
            ]
        },
        "domain": {
            "type": "object",
            "properties": {
                "Lx": {
                    "type": "integer"
                },
                "Ly": {
                    "type": "integer"
                },
                "Lz": {
                    "type": "integer"
                },
                "dx": {
                    "type": "number"
                },
                "dy": {
                    "type": "number"
                },
                "dz": {
                    "type": "number"
                },
                "origin": {
                    "type": "string",
                    "enum": [
                        "center",
                        "corner"
                    ]
                }
            },
            "required": [
                "Lx",
                "Ly",
                "Lz",
                "dx",
                "dy",
                "dz",
                "origin"
            ]
        },
        "timestepping": {
            "type": "object",
            "properties": {
                "t0": {
                    "type": "number"
                },
                "t1": {
                    "type": "number"
                },
                "dt": {
                    "type": "number"
                },
                "saveat": {
                    "type": "number"
                }
            },
            "required": [
                "t0",
                "t1",
                "dt",
                "saveat"
            ]
        },
        "fields": {
            "type": "array",
            "items": {
                "type": "object",
                "properties": {
                    "name": {
                        "type": "string"
                    },
                    "data": {
                        "type": "string"
                    }
                },
                "required": [
                    "name",
                    "data"
                ]
            }
        },
        "initial_conditions": {
            "type": "array",
            "items": {
                "oneOf": [
                    {
                        "$ref": "#/definitions/initial_conditions/constant"
                    },
                    {
                        "$ref": "#/definitions/initial_conditions/single_seed"
                    },
                    {
                        "$ref": "#/definitions/initial_conditions/seed_grid"
                    },
                    {
                        "$ref": "#/definitions/initial_conditions/from_file"
                    },
                    {
                        "$ref": "#/definitions/initial_conditions/seed_grid_fcc"
                    }
                ]
            }
        },
        "boundary_conditions": {
            "type": "array",
            "items": {
                "oneOf": [
                    {
                        "$ref": "#/definitions/boundary_conditions/fixed"
                    },
                    {
                        "$ref": "#/definitions/boundary_conditions/moving"
                    },
                    {
                        "$ref": "#/definitions/boundary_conditions/none"
                    }
                ]
            }
        },
        "detailed_timing": {
            "type": "object",
            "properties": {
                "enabled": {
                    "type": "boolean"
                },
                "print": {
                    "type": "boolean"
                },
                "write": {
                    "type": "boolean"
                },
                "filename": {
                    "type": "string"
                }
            }
        },
        "plan_options": {
            "type": "object",
            "properties": {
                "use_reorder": {
                    "type": "boolean"
                },
                "reshape_algorithm": {
                    "type": "string",
                    "enum": [
                        "alltoall",
                        "alltoallv",
                        "p2p",
                        "p2p_plined"
                    ]
                },
                "use_pencils": {
                    "type": "boolean"
                },
                "use_gpu_aware": {
                    "type": "boolean"
                }
            }
        },
        "simulator": {
            "type": "object",
            "properties": {
                "result_counter": {
                    "type": "integer"
                },
                "increment": {
                    "type": "integer"
                }
            }
        }
    },
    "required": [
        "model",
        "domain",
        "timestepping",
        "fields",
        "initial_conditions",
        "boundary_conditions"
    ],
    "definitions": {
        "models": {
            "tungsten": {
                "type": "object",
                "properties": {
                    "name": {
                        "type": "string",
                        "description": "model name",
                        "enum": [
                            "tungsten"
                        ]
                    },
                    "params": {
                        "type": "object",
                        "properties": {
                            "n0": {
                                "type": "number",
                                "description": "average density of the metastable fluid"
                            },
                            "alpha": {
                                "type": "number",
                                "description": "width of C2's peak"
                            },
                            "n_sol": {
                                "type": "number",
                                "description": "density of the solid"
                            },
                            "n_vap": {
                                "type": "number",
                                "description": "density of the vapor"
                            },
                            "T": {
                                "type": "number",
                                "description": "temperature of the metastable fluid (in K)"
                            },
                            "T0": {
                                "type": "number",
                                "description": "temperature of the solid (in K)"
                            },
                            "Bx": {
                                "type": "number"
                            },
                            "alpha_farTol": {
                                "type": "number",
                                "description": "how much we allow the k=1 peak to affect the k=0 value of the correlation, by changing the higher order components of the Gaussian function"
                            },
                            "alpha_highOrd": {
                                "type": "integer",
                                "description": "power of the higher order component of the gaussian function. Should be a multiple of 2. Setting this to zero also disables the tolerance setting."
                            },
                            "lambda": {
                                "type": "number",
                                "description": "strength of the meanfield filter"
                            },
                            "stabP": {
                                "type": "number",
                                "description": "numerical stability parameter for the exponential integrator method"
                            },
                            "shift_u": {
                                "type": "number",
                                "description": "vapor-model parameter"
                            },
                            "shift_s": {
                                "type": "number",
                                "description": "vapor-model parameter"
                            },
                            "p2": {
                                "type": "number",
                                "description": "vapor-model parameter"
                            },
                            "p3": {
                                "type": "number",
                                "description": "vapor-model parameter"
                            },
                            "p4": {
                                "type": "number",
                                "description": "vapor-model parameter"
                            },
                            "q20": {
                                "type": "number",
                                "description": "vapor-model parameter"
                            },
                            "q21": {
                                "type": "number",
                                "description": "vapor-model parameter"
                            },
                            "q30": {
                                "type": "number",
                                "description": "vapor-model parameter"
                            },
                            "q31": {
                                "type": "number",
                                "description": "vapor-model parameter"
                            },
                            "q40": {
                                "type": "number",
                                "description": "vapor-model parameter"
                            }
                        },
                        "required": [
                            "n0",
                            "alpha",
                            "n_sol",
                            "n_vap",
                            "T",
                            "T0",
                            "Bx",
                            "alpha_farTol",
                            "alpha_highOrd",
                            "lambda",
                            "stabP",
                            "shift_u",
                            "shift_s",
                            "p2",
                            "p3",
                            "p4",
                            "q20",
                            "q21",
                            "q30",
                            "q31",
                            "q40"
                        ]
                    }
                },
                "required": [
                    "name",
                    "params"
                ]
            },
            "aluminum": {
                "type": "object",
                "properties": {
                    "name": {
                        "type": "string",
                        "description": "model name",
                        "enum": [
                            "aluminum"
                        ]
                    },
                    "params": {
                        "type": "object",
                        "properties": {
                            "n0": {
                                "type": "number",
                                "description": "average density"
                            },
                            "alpha": {
                                "type": "number",
                                "description": "width of C2's peak"
                            },
                            "n_sol": {
                                "type": "number",
                                "description": "density of the solid"
                            },
                            "n_vap": {
                                "type": "number",
                                "description": "density of the vapor"
                            },
                            "T_const": {
                                "type": "number",
                                "description": "constant temperature"
                            },
                            "T_min": {
                                "type": "number",
                                "description": "minimum temperature"
                            },
                            "T_max": {
                                "type": "number",
                                "description": "maximum temperature"
                            },
                            "T0": {
                                "type": "number",
                                "description": "reference temperature"
                            },
                            "Bx": {
                                "type": "number"
                            },
                            "G_grid": {
                                "type": "number"
                            },
                            "V_grid": {
                                "type": "number"
                            },
                            "x_initial": {
                                "type": "number"
                            },
                            "alpha_farTol": {
                                "type": "number"
                            },
                            "alpha_highOrd": {
                                "type": "integer"
                            },
                            "lambda": {
                                "type": "number"
                            },
                            "stabP": {
                                "type": "number"
                            },
                            "shift_u": {
                                "type": "number"
                            },
                            "shift_s": {
                                "type": "number"
                            },
                            "p2_bar": {
                                "type": "number"
                            },
                            "p3_bar": {
                                "type": "number"
                            },
                            "p4_bar": {
                                "type": "number"
                            },
                            "q20_bar": {
                                "type": "number"
                            },
                            "q21_bar": {
                                "type": "number"
                            },
                            "q30_bar": {
                                "type": "number"
                            },
                            "q31_bar": {
                                "type": "number"
                            },
                            "q40_bar": {
                                "type": "number"
                            }
                        }
                    }
                },
                "required": [
                    "name",
                    "params"
                ]
            }
        },
        "initial_conditions": {
            "constant": {
                "type": "object",
                "description": "constant initial condition",
                "properties": {
                    "target": {
                        "type": "string"
                    },
                    "type": {
                        "type": "string",
                        "enum": [
                            "constant"
                        ]
                    },
                    "n0": {
                        "type": "number"
                    }
                },
                "required": [
                    "target",
                    "type",
                    "n0"
                ]
            },
            "single_seed": {
                "type": "object",
                "description": "single seed",
                "properties": {
                    "target": {
                        "type": "string"
                    },
                    "type": {
                        "type": "string",
                        "enum": [
                            "single_seed"
                        ]
                    },
                    "amp_eq": {
                        "type": "number"
                    },
                    "rho_seed": {
                        "type": "number"
                    }
                },
                "required": [
                    "target",
                    "type",
                    "amp_eq",
                    "rho_seed"
                ]
            },
            "seed_grid": {
                "type": "object",
                "description": "seed grid",
                "properties": {
                    "target": {
                        "type": "string"
                    },
                    "type": {
                        "type": "string",
                        "enum": [
                            "seed_grid"
                        ]
                    },
                    "amplitude": {
                        "type": "number"
                    },
                    "rho": {
                        "type": "number"
                    },
                    "radius": {
                        "type": "number"
                    },
                    "X0": {
                        "type": "number"
                    },
                    "Ny": {
                        "type": "integer"
                    },
                    "Nz": {
                        "type": "integer"
                    }
                },
                "required": [
                    "target",
                    "type",
                    "amplitude",
                    "rho",
                    "radius",
                    "X0",
                    "Ny",
                    "Nz"
                ]
            },
            "from_file": {
                "type": "object",
                "description": "read initial condition from file",
                "properties": {
                    "target": {
                        "type": "string"
                    },
                    "type": {
                        "type": "string",
                        "enum": [
                            "from_file"
                        ]
                    },
                    "filename": {
                        "type": "string"
                    }
                },
                "required": [
                    "target",
                    "type",
                    "filename"
                ]
            },
            "seed_grid_fcc": {
                "type": "object",
                "description": "FCC seed grid initial condition",
                "properties": {
                    "target": {
                        "type": "string"
                    },
                    "type": {
                        "type": "string",
                        "enum": [
                            "seed_grid_fcc"
                        ]
                    },
                    "amplitude": {
                        "type": "number"
                    },
                    "rho": {
                        "type": "number"
                    },
                    "radius": {
                        "type": "number"
                    },
                    "X0": {
                        "type": "number"
                    },
                    "Ny": {
                        "type": "integer"
                    },
                    "Nz": {
                        "type": "integer"
                    }
                },
                "required": [
                    "target",
                    "type",
                    "amplitude",
                    "rho",
                    "radius",
                    "X0",
                    "Ny",
                    "Nz"
                ]
            }
        },
        "boundary_conditions": {
            "fixed": {
                "type": "object",
                "properties": {
                    "target": {
                        "type": "string"
                    },
                    "type": {
                        "type": "string",
                        "enum": [
                            "fixed"
                        ]
                    },
                    "rho_low": {
                        "type": "number"
                    },
                    "rho_high": {
                        "type": "number"
                    }
                },
                "required": [
                    "target",
                    "type",
                    "rho_low",
                    "rho_high"
                ]
            },
            "moving": {
                "type": "object",
                "properties": {
                    "target": {
                        "type": "string"
                    },
                    "type": {
                        "type": "string",
                        "enum": [
                            "moving"
                        ]
                    },
                    "initial_position": {
                        "type": "string",
                        "enum": [
                            "end"
                        ]
                    },
                    "rho_low": {
                        "type": "number"
                    },
                    "rho_high": {
                        "type": "number"
                    },
                    "width": {
                        "type": "number"
                    },
                    "alpha": {
                        "type": "number"
                    },
                    "disp": {
                        "type": "number"
                    },
                    "xpos": {
                        "type": "number"
                    }
                },
                "required": [
                    "target",
                    "type",
                    "rho_low",
                    "rho_high",
                    "width",
                    "alpha",
                    "disp"
                ]
            },
            "none": {
                "type": "object",
                "description": "no boundary condition (which is the same as periodic boundary condition)",
                "properties": {
                    "target": {
                        "type": "string"
                    },
                    "type": {
                        "type": "string",
                        "enum": [
                            "none",
                            "periodic"
                        ]
                    }
                },
                "required": [
                    "target",
                    "type"
                ]
            }
        }
    }
}
